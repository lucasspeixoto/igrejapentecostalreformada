<p-toolbar class="mb-6">
  <ng-template #start>
    <p-button label="Novo" icon="pi pi-plus" severity="primary" class="mr-2" (onClick)="openInsertFixedAsset()" />
    <p-button
      severity="danger"
      label="Excluir"
      icon="pi pi-trash"
      (onClick)="deleteSelectedFixedAssets()"
      [disabled]="!selectedFixedAssets || !selectedFixedAssets.length" />
  </ng-template>
</p-toolbar>

<p-table
  #dt
  [value]="fixedAssetsViewModel.fixedAssets()"
  [rows]="10"
  [columns]="columns"
  [paginator]="true"
  [globalFilterFields]="['local', 'type', 'asset']"
  [tableStyle]="{ 'min-width': '75rem' }"
  [(selection)]="selectedFixedAssets"
  [scrollable]="true"
  scrollHeight="500px"
  [rowHover]="true"
  dataKey="id"
  currentPageReportTemplate="Exibindo {first} a {last} de {totalRecords} patrimônios"
  [showCurrentPageReport]="true"
  [rowsPerPageOptions]="[10, 20, 30, 50, 100]">
  <ng-template #caption>
    <div class="flex items-center justify-between flex-wrap gap-4">
      <h5 class="m-0">Patrimônios ({{ fixedAssetsViewModel.totalOfFixedAssets() }})</h5>
      <p-iconfield>
        <p-inputicon class="pi pi-search" />
        <input class="w-full sm:w-auto" pInputText type="text" (input)="onGlobalFilter(dt, $event)" placeholder="Pesquisar..." />
      </p-iconfield>
    </div>
  </ng-template>
  <ng-template #header>
    <tr>
      <th style="width: 3rem">
        <p-tableHeaderCheckbox />
      </th>
      <th pFrozenColumn pSortableColumn="local" style="min-width: 12rem">
        Local
        <p-sortIcon field="local" />
      </th>
      <th pSortableColumn="type">
        Tipo
        <p-sortIcon field="type" />
      </th>
      <th pSortableColumn="asset">
        Patrimônio
        <p-sortIcon field="asset" />
      </th>
      <th style="min-width: 12rem">Adicionado por</th>
      <th style="min-width: 8rem">Adicionado em</th>
      <th style="min-width: 8rem"></th>
    </tr>
  </ng-template>
  <ng-template #body let-fixedAsset>
    <tr>
      <td style="width: 3rem">
        <p-tableCheckbox [value]="fixedAsset" />
      </td>
      <td pFrozenColumn style="min-width: 12rem">{{ fixedAsset.local }}</td>
      <td>
        <span
          [ngClass]="{
            'shadow-indigo-500/50 bg-indigo-200 hover:bg-indigo-300 dark:bg-indigo-800 dark:hover:bg-indigo-700':
              fixedAsset.type === 'Equipamento',
            'shadow-cyan-500/50 bg-cyan-200 hover:bg-cyan-300 dark:bg-cyan-800 dark:hover:bg-cyan-700':
              fixedAsset.type === 'Móvel',
            'shadow-orange-500/50 bg-orange-200 hover:bg-orange-300 dark:bg-orange-800 dark:hover:bg-orange-700':
              fixedAsset.type === 'Imóvel',
            'shadow-green-500/50 bg-green-200 hover:bg-green-300 dark:bg-green-800 dark:hover:bg-green-700':
              fixedAsset.type === 'Veículo',
            'shadow-purple-500/50 bg-purple-200 hover:bg-purple-300 dark:bg-purple-800 dark:hover:bg-purple-700':
              fixedAsset.type === 'Hardware' || fixedAsset.type === 'Software' || fixedAsset.type === 'Periféricos',
            'shadow-pink-500/50 bg-pink-200 hover:bg-pink-300 dark:bg-pink-800 dark:hover:bg-pink-700':
              fixedAsset.type === 'Telefonia',
            'shadow-red-500/50 bg-red-200 hover:bg-red-300 dark:bg-red-800 dark:hover:bg-red-700':
              fixedAsset.type === 'Maquinário' || fixedAsset.type === 'Ferramentas',
            'shadow-yellow-500/50 bg-yellow-200 hover:bg-yellow-300 dark:bg-yellow-800 dark:hover:bg-yellow-700':
              fixedAsset.type === 'Benfeitorias' || fixedAsset.type === 'Instalações',
            'shadow-teal-500/50 bg-teal-200 hover:bg-teal-300 dark:bg-teal-800 dark:hover:bg-teal-700':
              fixedAsset.type === 'Utensílios' || fixedAsset.type === 'Decoração',
            'shadow-gray-500/50 bg-gray-200 hover:bg-gray-300 dark:bg-gray-800 dark:hover:bg-gray-700':
              fixedAsset.type === 'Intangível' || fixedAsset.type === 'Outros',
          }"
          class="select-none shadow-lg cursor-pointer inline-flex rounded-full px-3 py-2 transition-all duration-200 gap-2 items-center text-sm">
          <span
            [ngClass]="{
              'text-indigo-700': fixedAsset.type === 'Equipamento',
              'text-cyan-700': fixedAsset.type === 'Móvel',
              'text-orange-700': fixedAsset.type === 'Imóvel',
              'text-green-700': fixedAsset.type === 'Veículo',
              'text-purple-700':
                fixedAsset.type === 'Hardware' || fixedAsset.type === 'Software' || fixedAsset.type === 'Periféricos',
              'text-pink-700': fixedAsset.type === 'Telefonia',
              'text-red-700': fixedAsset.type === 'Maquinário' || fixedAsset.type === 'Ferramentas',
              'text-yellow-700': fixedAsset.type === 'Benfeitorias' || fixedAsset.type === 'Instalações',
              'text-teal-700': fixedAsset.type === 'Utensílios' || fixedAsset.type === 'Decoração',
              'text-gray-700': fixedAsset.type === 'Intangível' || fixedAsset.type === 'Outros',
            }"
            class="dark:text-green-50 font-medium"
            >{{ fixedAsset.type }}
          </span>
        </span>
      </td>
      <td>{{ fixedAsset.asset }}</td>
      <td>{{ fixedAsset.users?.full_name }}</td>
      <td>{{ fixedAsset.created_at | date: 'dd/MM/yyyy HH:mm:ss' }}</td>
      <td>
        <p-button icon="pi pi-pencil" severity="info" [rounded]="true" [text]="true" (click)="openUpdateFixedAsset(fixedAsset)" />
        <p-button
          icon="pi pi-trash"
          severity="danger"
          [rounded]="true"
          [text]="true"
          (click)="openDeleteFixedAsset(fixedAsset)" />
      </td>
    </tr>
  </ng-template>
</p-table>

<app-update-fixed-assets-dialog
  [fixedAssetsForm]="fixedAssetsForm"
  [fixedAssetsDialog]="fixedAssetsDialog"
  [modalTitle]="modalTitle()"
  (dialogClosed)="hideDialog()"
  (fixedAssetSaved)="saveFixedAssetHandler()">
</app-update-fixed-assets-dialog>

<p-confirmdialog [style]="{ width: '450px' }" />
